From 2745f17e68818cf898dcf504731ea01c8ca37a54 Mon Sep 17 00:00:00 2001
From: Yakup Akbay <yakbay@ubicom.com>
Date: Mon, 7 Dec 2009 11:08:52 +0200
Subject: [PATCH] Fix failures for DLNA CTT test cases 7.2.5.9 and 7.2.29.1.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Requirement [7.2.5.9]: The HTTP servers and clients of UPnP endpoints (devices and
control points) must include the Content-Type header tag in every UPnP-related TCP-
based HTTP transaction (SOAP GENA, and device/service description) that contains an
XML body. This content type must always be marked as the following:
   â€¢   text/xml; charset="utf-8"
---
 libgupnp/gupnp-service.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/libgupnp/gupnp-service.c b/libgupnp/gupnp-service.c
index ffae09c..5c60087 100644
--- a/libgupnp/gupnp-service.c
+++ b/libgupnp/gupnp-service.c
@@ -234,7 +234,7 @@ finalize_action (GUPnPServiceAction *action)
         response_body = g_string_free (action->response_str, FALSE);
 
         soup_message_set_response (action->msg,
-                                   "text/xml",
+                                   "text/xml; charset=\"utf-8\"",
                                    SOUP_MEMORY_TAKE,
                                    response_body,
                                    strlen (response_body));
-- 
1.6.4.4

